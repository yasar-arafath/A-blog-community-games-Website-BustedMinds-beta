(function(){var extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;I.UserHeader=function(superClass){extend(UserHeader,superClass);function UserHeader(){UserHeader.__super__.constructor.apply(this,arguments);this.el.dispatch("click",{edit_theme_btn:function(_this){return function(){return _this.toggle_theme_editor()}}(this)});if(window.location.hash.match(/\bedit_theme\b/)){_.defer(function(_this){return function(){return _this.toggle_theme_editor()}}(this))}}UserHeader.prototype.toggle_theme_editor=function(){var new_open;new_open=!I.theme_editor.state.open;I.theme_editor.setState({open:new_open});return $(document.body).toggleClass("theme_editor_open",new_open)};return UserHeader}(I.Header)}).call(this);(function(){I.UserPage=function(){UserPage.prototype.sticky_selector=".profile_column, .game_column";function UserPage(el,opts){this.opts=opts;this.el=$(el);this.setup_grid();this.setup_tracking();if(this.opts.ac){I.setup_affiliate_code(this.opts.ac)}}UserPage.prototype.setup_grid=function(){var cell_margin,lists;cell_margin=function(_this){return function(){if($(window).width()<500){return 10}else{return 20}}}(this);new I.GameGridSizer({el:this.el.find(".inner_column.profile_content"),container_selector:".mode_grid .user_game_grid",cell_margin:cell_margin,min_columns:2});this.grid=new I.GameGrid(this.el.find(".user_game_grid"),{sizer:false,show_popups:false});new I.GameGridSizer({el:this.el.find(".inner_column.profile_content"),container_selector:".game_grid_widget.game_list",cell_margin:cell_margin,expected_size:250,min_columns:2});lists=$(".purchased_games, .collections");lists.lazy_images({});return new I.GameCells(lists)};UserPage.prototype.setup_tracking=function(){I.setup_grid_referrers(this.el,function(_this){return function(){return"user:"+_this.opts.user_id}}(this));return I.tracked_links(this.el,"user")};return UserPage}()}).call(this);(function(){I.UserUserTools=function(){function UserUserTools(el){this.el=$(el);I.tracked_links(this.el,"view_user","user_tools");I.has_follow_button(this.el);setTimeout(function(_this){return function(){return _this.el.removeClass("hidden")}}(this),200)}return UserUserTools}();I.UserLayout=function(){function UserLayout(el){this.el=$(el);$(".user_page_wrap").max_height($(".header_widget").outerHeight(true)||0);new I.UserUserTools(this.el.find(".user_tools"))}return UserLayout}()}).call(this);(function(){I.libs.react.done(function(){var P,_rdf,a,br,button,code,div,em,fieldset,form,fragment,h1,h2,h3,h4,h5,h6,iframe,img,input,label,legend,li,ol,optgroup,option,p,pre,section,select,span,strong,textarea,types,ul;_rdf=ReactDOMFactories;div=_rdf.div,span=_rdf.span,a=_rdf.a,br=_rdf.br,p=_rdf.p,ol=_rdf.ol,ul=_rdf.ul,li=_rdf.li,strong=_rdf.strong,em=_rdf.em,img=_rdf.img,form=_rdf.form,label=_rdf.label,input=_rdf.input,textarea=_rdf.textarea,button=_rdf.button,iframe=_rdf.iframe,h1=_rdf.h1,h2=_rdf.h2,h3=_rdf.h3,h4=_rdf.h4,h5=_rdf.h5,h6=_rdf.h6,pre=_rdf.pre,code=_rdf.code,select=_rdf.select,option=_rdf.option,section=_rdf.section,optgroup=_rdf.optgroup,fieldset=_rdf.fieldset,legend=_rdf.legend;fragment=React.createElement.bind(null,React.Fragment);fragment.type=React.fragment;P=R["package"]("User");types=PropTypes;P("ToolTags",{getInitialState:function(){return{selected_tags:$.extend({},this.props.default_tags)}},componentDidMount:function(){},tags_by_id:function(){if(this._tags_by_id){return this._tags_by_id}this._tags_by_id={};this.props.tag_groups.forEach(function(_this){return function(group){return group.tags.forEach(function(tag){tag.group=group;return _this._tags_by_id[""+tag.id]=tag})}}(this));return this._tags_by_id},select_tag:function(id){var base,i,len,other_tag,ref,selected_tags,tag;selected_tags=$.extend({},this.state.selected_tags);tag=this.tags_by_id()[id];ref=tag.group.tags;for(i=0,len=ref.length;i<len;i++){other_tag=ref[i];delete selected_tags[other_tag.id]}selected_tags[tag.id]=true;this.setState({selected_tags:selected_tags});return typeof(base=this.props).on_select_tags==="function"?base.on_select_tags(selected_tags):void 0},unselect_group:function(group){var base,i,len,ref,selected_tags,tag;selected_tags=$.extend({},this.state.selected_tags);ref=group.tags;for(i=0,len=ref.length;i<len;i++){tag=ref[i];delete selected_tags[tag.id]}this.setState({selected_tags:selected_tags});return typeof(base=this.props).on_select_tags==="function"?base.on_select_tags(selected_tags):void 0},render:function(){var dropdowns;dropdowns=this.props.tag_groups.map(function(_this){return function(group){var options,selected_tag;selected_tag=group.tags.find(function(t){if(_this.state.selected_tags[t.id]){return true}});options=group.tags.map(function(tag){return{name:tag.name,value:tag.id}});if(!options.length){return}options.unshift({name:"Any",value:""});return R.Forms.SimpleSelect({key:group.slug,name:group.slug,value:(selected_tag!=null?selected_tag.id:void 0)||"default",render_current_option:function(current){if(current.value===""){return group.name}else{return strong({},current.name)}},onChange:function(value){var tag;tag=_this.tags_by_id()[value];if(tag){return _this.select_tag(tag.id)}else{return _this.unselect_group(group)}},options:options})}}(this));return this.enclose({},label({},"Filter games"),dropdowns,!$.isEmptyObject(this.state.selected_tags)?div({className:"clear_area"},a({href:"#",onClick:function(_this){return function(e){var base;e.preventDefault();_this.setState({selected_tags:{}});return typeof(base=_this.props).on_select_tags==="function"?base.on_select_tags({}):void 0}}(this)},"Clear filters")):void 0)}})})}).call(this);
